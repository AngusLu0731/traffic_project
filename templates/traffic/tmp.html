<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/Index.css' %}">
    <title>è·¯ç·šè¦åŠƒ</title>
</head>
<body class="I-body tmp-body">
    <div class="I-header">
        <h1><a href="/index">&#128664<span> äº¤ é€š é€š</span></a></h1>
        <ul class="I-option">
            <li><a href="/index">&#127968<span class="span-h">å›é¦–é </span></a></li>
            <li><a href="/edit"><span>ç·¨è¼¯é»ä½</span></a></li>
            <li><a href="/search"><span>ç¾æœ‰é»ä½</span></a></li>
            <li><a href="/gps"><span>äº¤é€šé€š</span></a></li>
        </ul>
    </div>
    <div class="tmp-div">
        <div class="tmp-content">
            <h1>&#127939 <span class="tmp-content-span">ä½ å¥½ï¼Œå»å“ªå‘¢ï¼Ÿ</span></h1>
            <div class="tmp-content1">
                <form class="tmp-content2"action="" method="POST">
                    {% csrf_token %}
                    {% if endPos != None %}
                    <input class="gps_input"type="text" name="endName" placeholder="EX:æƒ³å»å°åŒ—ç§‘å¤§æ‰“ã€ŒåŒ—ç§‘ã€" value= {{endPos}}>
                    {% else %}
                    <input class="gps_input"type="text" name="endName" placeholder="EX:æƒ³å»å°åŒ—ç§‘å¤§æ‰“ã€ŒåŒ—ç§‘ã€">
                    {% endif %}
                    <input type="hidden" id='nowLocationLatInput' name="nowLocationLat" value="">
                    <input type="hidden" id='nowLocationLngInput' name="nowLocationLng" value="">
                    <input class="gps_btn" id ="tmp-go "type="submit" value="GOï¼">
                </form>
            </div>
            {% if request.method == "POST" %} 
        </div>
        <div class="tmp-map">
            <div>
                {{ fmap|safe }}
            </div>
            <p class="tmp-map-p"><span class="tmp-map-span1">*è²¼å¿ƒæé†’* ğŸ“¢ </span><span class="tmp-map-span2">æ‰‹æ©Ÿã€å¹³æ¿</span>ç”¨æˆ¶å¯ä»¥æ©«å‘ï¼Œä¸¦å°‡ç¶²é ä¸‹æ‹‰ç²å–æ›´å¥½åœ°åœ–è¦–é‡</p>
        </div>
    </div>
    {% endif %} 
    <script>
        var latitude;
        var longitude;
        var nowLocation;
        var options = {
            enableHighAccuracy: true,
            timeout: 5000,
            maximumAge: 0
        };

        function success(pos) {
            var crd = pos.coords;
            console.log('Your current position is:');
            console.log('Latitude : ' + crd.latitude);
            latitude = '' + crd.latitude;
            console.log('Longitude : ' + crd.longitude);
            longitude = '' + crd.longitude;
            console.log('More or less ' + crd.accuracy + ' meters.');
            document.getElementById('nowLocationLatInput').value = latitude;
            document.getElementById('nowLocationLngInput').value = longitude;
        };
        function error(err) {
            console.warn('ERROR(' + err.code + '): ' + err.message);
        };

        navigator.geolocation.getCurrentPosition(success, error, options);
        // fetch('http://127.0.0.1:5000/gps?startLocationLat=' + latitude + '&startLocationLng=' + longitude + '&endLocationLat=25.03328829762747&endLocationLng=121.5700593227461')
        // .then(function(response) {
        //     return response;
        // })
        // .then(function(myJson) {
        //     console.log(myJson);
        // });
    </script>
</body>
</html> 